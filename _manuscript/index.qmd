---
title: Examinig claims of Racial Bias in Predictive Policing through a Geographic Perspective
format:
  html:
    code-fold: true
    code-summary: "Show code"
authors:
  - name: Fareeza Ali and Jackson Howes
    affiliation: Georgetown University
    corresponding: true
bibliography: references.bib

---
```{r}
library(tidyverse)
library(sf)
library(tidycensus)
library(tigris)
library(spdep)
```

# Abstract

Predictive policing systems have been repeatedly criticized for reproducing and amplifying racial disparities, yet empirical evaluation is complicated by the fact that ‚Äúcrime data‚Äù are not neutral measurements of underlying criminal behavior but administrative records produced through enforcement, reporting, and institutional decision-making. In this manuscript, we assess whether spatial patterns in recorded violent felony incidents changed in ways consistent with the claim that algorithmic policing intensified racially disparate enforcement. We adopt a geographic perspective, using NYPD precincts as the unit of analysis, violent felony complaint records as the outcome, and census-derived racial composition as the principal demographic covariate. Our design compares a pre-period (2010‚Äì2012) and a post-period (2013‚Äì2019) bracketing the implementation window of Patternizr, a predictive policing system introduced by the NYPD in 2013. We quantify global spatial autocorrelation in both crime rates and Black population share using Moran‚Äôs \(I\), identify local clusters using Local Indicators of Spatial Association (LISA), and assess whether observed clustering exceeds what would be expected under a population-proportional null model via Monte Carlo simulation. Finally, we use geographically weighted regression (GWR) to examine whether the relationship between racial composition and recorded crime rates became more spatially heterogeneous over time. We emphasize throughout that any observed differences are associational rather than causal, given concurrent neighborhood change and other confounds; nonetheless, this framework isolates concrete, testable spatial signatures that are directly relevant to claims of algorithmically mediated bias.

# Introduction

Public and scholarly debates over predictive policing have increasingly centered on a shared concern: that algorithmic systems trained on historically patterned enforcement data may re-entrench and intensify the very disparities they purport to mitigate. In the specific context of New York City, Patternizr has been described as a tool intended to assist in recognizing potentially related crime patterns; however, even systems framed as investigative aids may shape enforcement attention and thereby the geography of recorded crime. When police deploy resources unevenly across space, administrative ‚Äúcrime‚Äù data can reflect both underlying incidents and the spatial distribution of policing itself. As a result, testing claims of algorithmic bias requires methodological approaches that can separate (or at minimum, describe) changes in spatial concentration and demographic overlap.

We therefore pose a geographically grounded question: did the spatial structure of recorded violent felony crime become more clustered after the implementation of Patternizr, and did the geography of those clusters align differently with the geography of Black residential concentration? Importantly, our inferential target is not a direct causal estimate of Patternizr‚Äôs effect. Instead, we evaluate whether the *spatial signatures* of recorded crime‚Äîglobal clustering, local hot spots, and hot-spot overlap with racially concentrated precincts‚Äîchanged in ways that are consistent with common critiques of predictive policing. We explicitly treat demographic change, including gentrification and population redistribution between 2010 and 2020, as a major confound that must be described alongside any policing-related interpretation.

# Research Questions and Hypotheses

Our analysis is organized around three primary research questions.

1. **Did the spatial clustering of violent felony *crime rates* change between the pre-Patternizr and post-Patternizr periods?**  
   If predictive policing concentrated enforcement attention into a narrower set of precincts, we would expect increased spatial autocorrelation in recorded crime rates. This motivates comparison of global Moran‚Äôs \(I\) for precinct-level crime rates across periods.

2. **Did the spatial clustering of Black residential concentration change over the same window, and how does it relate to crime clustering?**  
   Racial residential segregation produces strong spatial autocorrelation in demographic composition. If this structure is stable while crime clustering changes, then changes in the *relationship* between demographic clustering and crime clustering become substantively interpretable.

3. **Did the overlap between crime hot spots and Black population hot spots change?**  
   We operationalize ‚Äúhot spot‚Äù using LISA High‚ÄìHigh clusters. A reduction in overlap may indicate either (i) a weakening association between racial concentration and recorded crime hot spots, or (ii) demographic change in the precincts that previously occupied both categories.

In addition, we use geographically weighted regression (GWR) as a diagnostic to evaluate whether the local association between percent Black and precinct crime rates became more spatially heterogeneous over time. Substantively, a shift toward stronger spatial non-stationarity is consistent with a more localized policing geography, but this pattern can also arise from localized neighborhood change and other place-specific dynamics.

# Data and Study Design

## Spatial Units and Coordinate Systems

The unit of analysis is the NYPD precinct. We load an official precinct boundary shapefile and project it to an equal-area / planar coordinate system appropriate for spatial operations (EPSG:32118). All spatial overlays and neighborhood constructions (contiguity weights) are conducted in this projected CRS to ensure that area calculations and adjacency relationships are well-defined.

LOAD PRECINT SHAPEFILE
```{r}
precincts <- st_read("data/data/nyc_precincts.geojson")
precincts_proj <- st_transform(precincts, 32118)
```

## Demographic Data: Census Blocks to Precincts via Areal Interpolation

Because precinct boundaries do not align with census block boundaries, we construct precinct-level demographics using areal interpolation. Specifically, we obtain census block geometries and block-level decennial census counts for 2010 and 2020. For each census year, we intersect census blocks with precinct polygons, compute the proportion of each block‚Äôs area contained within each precinct, and allocate block-level counts proportionally to those intersection weights. Summing the allocated counts across intersections yields precinct-level demographic totals.

DOWNLOAD 2020 BLOCK GEOMs
```{r}
blocks_2020 <- st_read("data/data/tl_2020_36_tabblock20/tl_2020_36_tabblock20.shp")

nyc_counties <- c("005", "047", "061", "081", "085")
blocks_2020_nyc <- blocks_2020 %>%
  filter(COUNTYFP20 %in% nyc_counties)

# Pull 2020 census data
p1_2020 <- get_decennial(
  geography = "block",
  variables = c("P1_001N", "P1_003N", "P1_004N", "P1_005N", 
                "P1_006N", "P1_007N", "P1_008N", "P1_009N"),
  state = "NY",
  county = nyc_counties,
  year = 2020,
  output = "wide"
)

p2_2020 <- get_decennial(
  geography = "block",
  variables = c("P2_001N", "P2_002N", "P2_003N"),
  state = "NY",
  county = nyc_counties,
  year = 2020,
  output = "wide"
)

# Join and interpolate 2020 data to precincts
p1_2020 <- p1_2020 %>% rename(GEOID20 = GEOID)
p2_2020 <- p2_2020 %>% rename(GEOID20 = GEOID)

blocks_demo_2020 <- blocks_2020_nyc %>%
  left_join(p1_2020, by = "GEOID20") %>%
  left_join(p2_2020, by = "GEOID20")

blocks_2020_proj <- st_transform(blocks_demo_2020, 32118)

blocks_2020_proj <- blocks_2020_proj %>%
  mutate(block_area = st_area(geometry))

block_precinct_int_2020 <- st_intersection(blocks_2020_proj, precincts_proj)

block_precinct_int_2020 <- block_precinct_int_2020 %>%
  mutate(
    piece_area = st_area(geometry),
    weight = as.numeric(piece_area / block_area)
  )

demo_vars_2020 <- c("P1_001N", "P1_003N", "P1_004N", "P1_005N",
                    "P1_006N", "P1_007N", "P1_008N", "P1_009N",
                    "P2_001N", "P2_002N", "P2_003N")

for (v in demo_vars_2020) {
  block_precinct_int_2020[[paste0(v, "_alloc")]] <-
    block_precinct_int_2020[[v]] * block_precinct_int_2020$weight
}

precinct_demographics_2020 <- block_precinct_int_2020 %>%
  st_drop_geometry() %>%
  group_by(precinct) %>%
  summarise(across(ends_with("_alloc"), sum, na.rm = TRUE))

precincts_2020 <- precincts_proj %>%
  left_join(precinct_demographics_2020, by = "precinct")
```

DOWNLOAD 2010 BLOCK GEOMs
```{r}
blocks_2010 <- blocks(state = "NY", county = nyc_counties, year = 2010)

blocks_2010_nyc <- blocks_2010 %>%
  filter(COUNTYFP10 %in% nyc_counties)

# Pull 2010 census data
p1_2010 <- get_decennial(
  geography = "block",
  variables = c("P003001", "P003002", "P003003", "P003004",
                "P003005", "P003006", "P003007", "P003008"),
  state = "NY",
  county = nyc_counties,
  year = 2010,
  output = "wide"
)

p2_2010 <- get_decennial(
  geography = "block",
  variables = c("P004001", "P004002", "P004003"),
  state = "NY",
  county = nyc_counties,
  year = 2010,
  output = "wide"
)

# Join and interpolate 2010 data to precincts
p1_2010 <- p1_2010 %>% rename(GEOID10 = GEOID)
p2_2010 <- p2_2010 %>% rename(GEOID10 = GEOID)

blocks_demo_2010 <- blocks_2010_nyc %>%
  left_join(p1_2010, by = "GEOID10") %>%
  left_join(p2_2010, by = "GEOID10")

blocks_2010_proj <- st_transform(blocks_demo_2010, 32118)

blocks_2010_proj <- blocks_2010_proj %>%
  mutate(block_area = st_area(geometry))

block_precinct_int_2010 <- st_intersection(blocks_2010_proj, precincts_proj)

block_precinct_int_2010 <- block_precinct_int_2010 %>%
  mutate(
    piece_area = st_area(geometry),
    weight = as.numeric(piece_area / block_area)
  )

demo_vars_2010 <- c("P003001", "P003002", "P003003", "P003004",
                    "P003005", "P003006", "P003007", "P003008",
                    "P004001", "P004002", "P004003")

for (v in demo_vars_2010) {
  block_precinct_int_2010[[paste0(v, "_alloc")]] <-
    block_precinct_int_2010[[v]] * block_precinct_int_2010$weight
}

precinct_demographics_2010 <- block_precinct_int_2010 %>%
  st_drop_geometry() %>%
  group_by(precinct) %>%
  summarise(across(ends_with("_alloc"), sum, na.rm = TRUE))

precincts_2010 <- precincts_proj %>%
  left_join(precinct_demographics_2010, by = "precinct")
```

Formally, let \(b\) index census blocks and \(p\) index precincts. Define the intersection area \(A_{bp} = \text{area}(b \cap p)\) and block area \(A_b = \text{area}(b)\). The areal weight is

$$
w_{bp} = \frac{A_{bp}}{A_b}.
$$

For a block-level count \(X_b\) (e.g., total population, race counts), the precinct-allocated contribution from block \(b\) is

$$
X_{bp}^{\text{alloc}} = w_{bp} X_b,
$$

and the precinct-level total is

$$
X_p = \sum_{b} X_{bp}^{\text{alloc}}.
$$

We then compute precinct demographic shares (e.g., percent Black) as

$$
\%Black_p = 100 \times \frac{Black_p}{TotalPop_p},
$$

with analogous definitions for percent Hispanic and percent White.

This approach implicitly assumes uniform population density within each block. While imperfect, it is standard practice when translating census counts to non-nested administrative boundaries, and it produces internally consistent precinct-level denominators for per-capita crime rate computation.

## Crime Data: Violent Felony Complaint Records

We load a cleaned violent felony complaint dataset from the city containing point locations (latitude/longitude) and complaint dates. Complaint points are converted into an `sf` point object in WGS84 (EPSG:4326) and then filtered to a bounding box corresponding to New York City to remove obvious geocoding errors. Points are subsequently projected into EPSG:32118 for spatial joins and distance-consistent operations. Complaint dates are parsed to extract year, enabling period-based subsetting.

STANDARDIZE COL NAMES
```{r}
precincts_2010 <- precincts_2010 %>%
  rename(
    total_pop_alloc = P003001_alloc,
    white_alloc = P003002_alloc,
    black_alloc = P003003_alloc,
    aian_alloc = P003004_alloc,
    asian_alloc = P003005_alloc,
    nhpi_alloc = P003006_alloc,
    other_alloc = P003007_alloc,
    two_or_more_alloc = P003008_alloc,
    hispanic_total_alloc = P004001_alloc,
    hispanic_alloc = P004002_alloc,
    not_hispanic_alloc = P004003_alloc
  )

precincts_2020 <- precincts_2020 %>%
  rename(
    total_pop_alloc = P1_001N_alloc,
    white_alloc = P1_003N_alloc,
    black_alloc = P1_004N_alloc,
    aian_alloc = P1_005N_alloc,
    asian_alloc = P1_006N_alloc,
    nhpi_alloc = P1_007N_alloc,
    other_alloc = P1_008N_alloc,
    two_or_more_alloc = P1_009N_alloc,
    hispanic_total_alloc = P2_001N_alloc,
    hispanic_alloc = P2_002N_alloc,
    not_hispanic_alloc = P2_003N_alloc
  )
```

LOAD AND PREP CRIME DATA
```{r}
violent_crimes <- read.csv("data/data/violent_felony_cleaned_13.csv")

violent_sf <- st_as_sf(
  violent_crimes,
  coords = c("long", "lat"),
  crs = 4326
)

violent_sf <- violent_sf %>%
  filter(
    !is.na(geometry),
    sf::st_coordinates(geometry)[, 1] > -74.5,
    sf::st_coordinates(geometry)[, 1] < -73.7,
    sf::st_coordinates(geometry)[, 2] > 40.45,
    sf::st_coordinates(geometry)[, 2] < 40.95
  )

violent_proj <- st_transform(violent_sf, 32118)

violent_proj <- violent_proj %>%
  mutate(
    complaint_date = as.Date(complaint_date),
    year = as.integer(format(complaint_date, "%Y"))
  )
```

## Pre/Post Comparison Windows

To reduce transitional ambiguity surrounding the implementation timeline, we define two non-overlapping windows:

- **Before**: 2010‚Äì2012  
- **After**: 2013‚Äì2019  

For each period, we spatially join complaint points to precinct polygons, count incidents per precinct, and compute the precinct-level violent felony rate per 1,000 residents:

$$
CrimeRate_p = 1000 \times \frac{Crimes_p}{TotalPop_p}.
$$

We exclude precinct 22 (Central Park) due to its negligible residential population, which otherwise induces artificially inflated per-capita rates and undermines interpretability.

BEFORE/AFTER DATASETS
```{r}
# Filter crimes by period
crimes_before <- violent_proj %>% filter(year >= 2010 & year <= 2012)
crimes_after <- violent_proj %>% filter(year >= 2013 & year <= 2019)

print(paste("Crimes before (2010-2012):", nrow(crimes_before)))
print(paste("Crimes after (2013-2019):", nrow(crimes_after)))

# Count crimes per precinct - BEFORE
crime_counts_before <- crimes_before %>%
  st_join(precincts_proj, join = st_within) %>%
  st_drop_geometry() %>%
  group_by(precinct) %>%
  summarise(total_crimes = n(), .groups = "drop")

precincts_before <- precincts_2010 %>%
  left_join(crime_counts_before, by = "precinct") %>%
  mutate(
    total_crimes = replace_na(total_crimes, 0),
    crime_rate = (total_crimes / total_pop_alloc) * 1000,
    pct_black = (black_alloc / total_pop_alloc) * 100,
    pct_hispanic = (hispanic_alloc / total_pop_alloc) * 100,
    pct_white = (white_alloc / total_pop_alloc) * 100
  )

# Count crimes per precinct - AFTER
crime_counts_after <- crimes_after %>%
  st_join(precincts_proj, join = st_within) %>%
  st_drop_geometry() %>%
  group_by(precinct) %>%
  summarise(total_crimes = n(), .groups = "drop")

precincts_after <- precincts_2020 %>%
  left_join(crime_counts_after, by = "precinct") %>%
  mutate(
    total_crimes = replace_na(total_crimes, 0),
    crime_rate = (total_crimes / total_pop_alloc) * 1000,
    pct_black = (black_alloc / total_pop_alloc) * 100,
    pct_hispanic = (hispanic_alloc / total_pop_alloc) * 100,
    pct_white = (white_alloc / total_pop_alloc) * 100
  )
```
```{r}
# Remove Central Park (Precinct 22) - negligible residential population
precincts_before <- precincts_before %>% filter(precinct != "22")
precincts_after <- precincts_after %>% filter(precinct != "22")

print(paste("Precincts remaining (before):", nrow(precincts_before)))
print(paste("Precincts remaining (after):", nrow(precincts_after)))

# Verify new summary stats
print("=== BEFORE (excluding Central Park) ===")
print(summary(precincts_before$crime_rate))

print("=== AFTER (excluding Central Park) ===")
print(summary(precincts_after$crime_rate))
```

# Methods Overview

Our empirical strategy combines global measures of spatial autocorrelation, local cluster detection, a simulation-based null model to benchmark observed clustering, and a spatially varying regression diagnostic. These components correspond directly to the computational workflow implemented below.

## Global Spatial Autocorrelation: Moran‚Äôs \(I\)

We quantify global spatial autocorrelation using Moran‚Äôs \(I\) for two variables: (a) precinct crime rates and (b) percent Black population. Spatial dependence is defined using a queen contiguity neighborhood structure (shared edges or corners). Let \(x_p\) denote a precinct-level variable (e.g., crime rate) and \(\bar{x}\) its mean. With spatial weights \(w_{pq}\) (row-standardized), Moran‚Äôs \(I\) is

$$
I = \frac{n}{S_0}\frac{\sum_{p}\sum_{q} w_{pq}(x_p - \bar{x})(x_q - \bar{x})}{\sum_{p}(x_p - \bar{x})^2},
$$

where \(n\) is the number of precincts and \(S_0 = \sum_{p}\sum_{q} w_{pq}\). We compute Moran‚Äôs \(I\) separately for each period and interpret differences as changes in the degree of clustering in the precinct-level surfaces.

VERIFY DATA & check for outliers
```{r}
# Summary stats
print("=== BEFORE PERIOD (2010-2012 crimes + 2010 census) ===")
print(paste("N precincts:", nrow(precincts_before)))
print(summary(precincts_before$crime_rate))
print(summary(precincts_before$pct_black))

print("=== AFTER PERIOD (2013-2019 crimes + 2020 census) ===")
print(paste("N precincts:", nrow(precincts_after)))
print(summary(precincts_after$crime_rate))
print(summary(precincts_after$pct_black))

# Top crime rate precincts (sanity check)
print("=== Top 5 crime rates - BEFORE ===")
precincts_before %>%
  st_drop_geometry() %>%
  select(precinct, total_crimes, total_pop_alloc, crime_rate) %>%
  arrange(desc(crime_rate)) %>%
  head(5)
```

SPATIAL WEIGHTS AND MORANS I
CREATE SPATIAL WEIGHTS MATRIX
```{r}
# We need to create weights for BOTH datasets
# Since we removed precinct 22, we need fresh neighbor structures

# Convert to sp objects for spdep
precincts_before_sp <- as(precincts_before, "Spatial")
precincts_after_sp <- as(precincts_after, "Spatial")

# Create queen contiguity neighbors (precincts sharing edges or corners)
nb_before <- poly2nb(precincts_before_sp, queen = TRUE)
nb_after <- poly2nb(precincts_after_sp, queen = TRUE)

# Convert to spatial weights (row-standardized)
weights_before <- nb2listw(nb_before, style = "W", zero.policy = TRUE)
weights_after <- nb2listw(nb_after, style = "W", zero.policy = TRUE)

print("Spatial weights created successfully")
print(paste("Average # of neighbors (before):", round(mean(card(nb_before)), 2)))
print(paste("Average # of neighbors (after):", round(mean(card(nb_after)), 2)))

```

GLOBAL MORANS I FOR CRIME RATE
```{r}
print("========== GLOBAL MORAN'S I: CRIME RATE ==========")

# Before period
moran_crime_before <- moran.test(precincts_before$crime_rate, weights_before)
print("--- BEFORE (2010-2012) ---")
print(moran_crime_before)

# After period
moran_crime_after <- moran.test(precincts_after$crime_rate, weights_after)
print("--- AFTER (2013-2019) ---")
print(moran_crime_after)

```

GOBAL MORANS I FOR PERCENT OF BLACK POP
```{r}
print("========== GLOBAL MORAN'S I: PCT BLACK ==========")

# Before period
moran_black_before <- moran.test(precincts_before$pct_black, weights_before)
print("--- BEFORE (2010-2012) ---")
print(moran_black_before)

# After period
moran_black_after <- moran.test(precincts_after$pct_black, weights_after)
print("--- AFTER (2013-2019) ---")
print(moran_black_after)
```

SUMMARY TABLE
```{r}
moran_summary <- data.frame(
  Variable = c("Crime Rate", "Crime Rate", "Pct Black", "Pct Black"),
  Period = c("Before", "After", "Before", "After"),
  Morans_I = c(
    moran_crime_before$estimate["Moran I statistic"],
    moran_crime_after$estimate["Moran I statistic"],
    moran_black_before$estimate["Moran I statistic"],
    moran_black_after$estimate["Moran I statistic"]
  ),
  P_Value = c(
    moran_crime_before$p.value,
    moran_crime_after$p.value,
    moran_black_before$p.value,
    moran_black_after$p.value
  )
)

print("========== MORAN'S I SUMMARY ==========")
print(moran_summary)
```

## Local Moran‚Äôs \(I\) and LISA Cluster Typology

To identify localized clusters and spatial outliers, we compute Local Moran‚Äôs \(I\) (LISA) for both crime rates and percent Black. We classify each precinct into one of five categories based on the sign of its standardized value and the sign of its spatial lag (neighbors‚Äô average), conditional on statistical significance:

- High‚ÄìHigh (hot spot): high value surrounded by high values  
- Low‚ÄìLow (cold spot): low value surrounded by low values  
- High‚ÄìLow: high outlier surrounded by low values  
- Low‚ÄìHigh: low outlier surrounded by high values  
- Not significant

The substantive comparison is whether High‚ÄìHigh crime precincts co-occur with High‚ÄìHigh Black precincts, and whether the count (and identity) of overlapping precincts changes from the pre-period to the post-period.

LOCAL MORANS I (LISA)
```{r}
# BEFORE period
lisa_crime_before <- localmoran(precincts_before$crime_rate, weights_before)
lisa_black_before <- localmoran(precincts_before$pct_black, weights_before)

# AFTER period
lisa_crime_after <- localmoran(precincts_after$crime_rate, weights_after)
lisa_black_after <- localmoran(precincts_after$pct_black, weights_after)
```

CREATE LISA CLUSTER CATS
```{r}
get_lisa_clusters <- function(variable, lisa_output, weights) {
  # Get standardized values
  z <- scale(variable)[,1]
  
  # Get lagged values (neighbors' average)
  lag_z <- lag.listw(weights, z)
  
  # Get p-values (using column 5: Pr(z != E(Ii)))
  p_value <- lisa_output[, 5]
  
  # Classify into quadrants
  cluster <- case_when(
    p_value > 0.05 ~ "Not Significant",
    z > 0 & lag_z > 0 ~ "High-High",
    z < 0 & lag_z < 0 ~ "Low-Low",
    z > 0 & lag_z < 0 ~ "High-Low",
    z < 0 & lag_z > 0 ~ "Low-High",
    TRUE ~ "Not Significant"
  )
  
  return(cluster)
}

# Apply to all four combinations
precincts_before$lisa_crime <- get_lisa_clusters(
  precincts_before$crime_rate, lisa_crime_before, weights_before
)
precincts_before$lisa_black <- get_lisa_clusters(
  precincts_before$pct_black, lisa_black_before, weights_before
)

precincts_after$lisa_crime <- get_lisa_clusters(
  precincts_after$crime_rate, lisa_crime_after, weights_after
)
precincts_after$lisa_black <- get_lisa_clusters(
  precincts_after$pct_black, lisa_black_after, weights_after
)
```

SUMMARY TABLE
```{r}
print("=== LISA Clusters: CRIME RATE ===")
print("BEFORE:")
print(table(precincts_before$lisa_crime))
print("AFTER:")
print(table(precincts_after$lisa_crime))

print("=== LISA Clusters: PCT BLACK ===")
print("BEFORE:")
print(table(precincts_before$lisa_black))
print("AFTER:")
print(table(precincts_after$lisa_black))
```

KEY QUESTION - OVERLAP
```{r}
print("=== OVERLAP: High-High Crime AND High-High Black ===")

# Before period
overlap_before <- precincts_before %>%
  st_drop_geometry() %>%
  filter(lisa_crime == "High-High" & lisa_black == "High-High") %>%
  select(precinct, crime_rate, pct_black)

print("BEFORE - Precincts that are High-High for BOTH crime and Black population:")
print(overlap_before)
print(paste("Count:", nrow(overlap_before)))

# After period
overlap_after <- precincts_after %>%
  st_drop_geometry() %>%
  filter(lisa_crime == "High-High" & lisa_black == "High-High") %>%
  select(precinct, crime_rate, pct_black)

print("AFTER - Precincts that are High-High for BOTH crime and Black population:")
print(overlap_after)
print(paste("Count:", nrow(overlap_after)))

```

CROSS TABULATION
```{r}

print("=== Full Cross-Tabulation: Crime Clusters vs Black Clusters ===")
print("BEFORE:")
print(table(precincts_before$lisa_crime, precincts_before$lisa_black))

print("AFTER:")
print(table(precincts_after$lisa_crime, precincts_after$lisa_black))
```


```{r}
# What happened to precincts 73, 77, 81?
track_precincts <- c("73", "77", "81")

print("=== Tracking Precincts 73, 77, 81 ===")

print("BEFORE (2010-2012):")
precincts_before %>%
  st_drop_geometry() %>%
  filter(precinct %in% track_precincts) %>%
  select(precinct, total_crimes, crime_rate, pct_black, lisa_crime, lisa_black) %>%
  print()

print("AFTER (2013-2019):")
precincts_after %>%
  st_drop_geometry() %>%
  filter(precinct %in% track_precincts) %>%
  select(precinct, total_crimes, crime_rate, pct_black, lisa_crime, lisa_black) %>%
  print()

# Also: which precincts ARE High-High for crime in the AFTER period?
print("=== Which precincts are High-High for crime AFTER? ===")
precincts_after %>%
  st_drop_geometry() %>%
  filter(lisa_crime == "High-High") %>%
  select(precinct, crime_rate, pct_black, lisa_black) %>%
  print()

# And which are High-High for Black population AFTER?
print("=== Which precincts are High-High for Black pop AFTER? ===")
precincts_after %>%
  st_drop_geometry() %>%
  filter(lisa_black == "High-High") %>%
  select(precinct, crime_rate, pct_black, lisa_crime) %>%
  print()
```


## Monte Carlo Null Model for Crime Clustering

Global Moran‚Äôs \(I\) can be statistically significant even under modest clustering when sample sizes are large; more importantly, observed clustering may reflect population distribution rather than any additional geographic process. We therefore implement a Monte Carlo simulation under a population-proportional null:

- The total number of crimes observed in a period is held fixed.
- Crimes are randomly allocated to precincts with probability proportional to precinct population.
- Simulated crime rates are computed and Moran‚Äôs \(I\) is evaluated for each simulation.

Let \(C\) be the observed number of crimes in a period and \(p_p = \frac{Pop_p}{\sum_q Pop_q}\). A single simulation draws precinct crime counts

$$
(C_1,\ldots,C_n) \sim \text{Multinomial}\left(C; p_1,\ldots,p_n\right),
$$

and constructs simulated rates \(CrimeRate_p^{(s)} = 1000 \times \frac{C_p}{Pop_p}\). Repeating this process yields an empirical null distribution of Moran‚Äôs \(I\). We compute the Monte Carlo p-value as the proportion of simulated Moran‚Äôs \(I\) values greater than or equal to the observed \(I\) (with a standard +1 correction):

$$
p = \frac{\#\{I^{(s)} \ge I^{obs}\} + 1}{S + 1},
$$

where \(S\) is the number of simulations.

MONTE CARLO SIMULATION
```{r}
set.seed(65)
simulate_morans_i <- function(precincts_df, weights, n_sims = 999) {
  
  # Get total crimes and population
  total_crimes <- sum(precincts_df$total_crimes)
  populations <- precincts_df$total_pop_alloc
  total_pop <- sum(populations)
  
  # Population proportions (probability of crime in each precinct under null)
  pop_proportions <- populations / total_pop
  
  # Store simulated Moran's I values
  sim_morans <- numeric(n_sims)
  
  # Run simulations
  for (i in 1:n_sims) {
    # Randomly allocate crimes proportional to population
    # Each crime is assigned to a precinct with probability = pop proportion
    sim_crimes <- rmultinom(1, size = total_crimes, prob = pop_proportions)[,1]
    
    # Calculate simulated crime rate
    sim_rate <- (sim_crimes / populations) * 1000
    
    # Handle any Inf values (shouldn't happen but just in case)
    sim_rate[is.infinite(sim_rate)] <- 0
    
    # Calculate Moran's I for this simulation
    sim_moran <- moran(sim_rate, weights, n = length(sim_rate), S0 = Szero(weights))
    sim_morans[i] <- sim_moran$I
    
    # Progress indicator
    if (i %% 100 == 0) {
      cat("Completed", i, "of", n_sims, "simulations\n")
    }
  }
  
  return(sim_morans)
}
```

RUN SIMS FOR BEFORE
```{r}
cat("\n========== BEFORE PERIOD SIMULATION ==========\n")

# Observed Moran's I
observed_moran_before <- moran(
  precincts_before$crime_rate, 
  weights_before, 
  n = nrow(precincts_before), 
  S0 = Szero(weights_before)
)$I

cat("Observed Moran's I (Before):", round(observed_moran_before, 4), "\n\n")

# Run simulation
cat("Running 999 simulations under null hypothesis...\n")
sim_morans_before <- simulate_morans_i(precincts_before, weights_before, n_sims = 999)

# Calculate p-value (proportion of simulated values >= observed)
p_value_before <- (sum(sim_morans_before >= observed_moran_before) + 1) / (999 + 1)

cat("\nSimulation Results (Before):\n")
cat("  Mean simulated Moran's I:", round(mean(sim_morans_before), 4), "\n")
cat("  SD simulated Moran's I:", round(sd(sim_morans_before), 4), "\n")
cat("  Observed Moran's I:", round(observed_moran_before, 4), "\n")
cat("  Monte Carlo p-value:", round(p_value_before, 4), "\n")
```

RUN SIMS FOR AFTER
```{r}
cat("\n========== AFTER PERIOD SIMULATION ==========\n")

# Observed Moran's I
observed_moran_after <- moran(
  precincts_after$crime_rate, 
  weights_after, 
  n = nrow(precincts_after), 
  S0 = Szero(weights_after)
)$I

cat("Observed Moran's I (After):", round(observed_moran_after, 4), "\n\n")

# Run simulation
cat("Running 999 simulations under null hypothesis...\n")
sim_morans_after <- simulate_morans_i(precincts_after, weights_after, n_sims = 999)

# Calculate p-value
p_value_after <- (sum(sim_morans_after >= observed_moran_after) + 1) / (999 + 1)

cat("\nSimulation Results (After):\n")
cat("  Mean simulated Moran's I:", round(mean(sim_morans_after), 4), "\n")
cat("  SD simulated Moran's I:", round(sd(sim_morans_after), 4), "\n")
cat("  Observed Moran's I:", round(observed_moran_after, 4), "\n")
cat("  Monte Carlo p-value:", round(p_value_after, 4), "\n")
```

visualize histogram of sims
```{r}
# Create data frame for plotting
sim_df <- data.frame(
  Morans_I = c(sim_morans_before, sim_morans_after),
  Period = rep(c("Before (2010-2012)", "After (2013-2019)"), each = 999)
)

observed_df <- data.frame(
  Morans_I = c(observed_moran_before, observed_moran_after),
  Period = c("Before (2010-2012)", "After (2013-2019)")
)

# Plot
monte_carlo_plot <- ggplot(sim_df, aes(x = Morans_I)) +
  geom_histogram(bins = 50, fill = "steelblue", alpha = 0.7, color = "white") +
  geom_vline(data = observed_df, aes(xintercept = Morans_I), 
             color = "red", linetype = "dashed", size = 1.2) +
  facet_wrap(~Period, ncol = 1) +
  theme_minimal() +
  labs(
    title = "Monte Carlo Simulation: Crime Rate Spatial Autocorrelation",
    subtitle = "Null hypothesis: Crime distributed proportionally to population",
    x = "Moran's I",
    y = "Frequency",
    caption = "Red dashed line = Observed Moran's I"
  ) +
  theme(
    strip.text = element_text(size = 12, face = "bold")
  )

print(monte_carlo_plot)

ggsave("monte_carlo_simulation.png", monte_carlo_plot, width = 10, height = 8)

```

SUMMARY TABLE
```{r}
mc_summary <- data.frame(
  Period = c("Before (2010-2012)", "After (2013-2019)"),
  Observed_Morans_I = c(observed_moran_before, observed_moran_after),
  Mean_Simulated = c(mean(sim_morans_before), mean(sim_morans_after)),
  SD_Simulated = c(sd(sim_morans_before), sd(sim_morans_after)),
  P_Value = c(p_value_before, p_value_after)
)

print("========== MONTE CARLO SUMMARY ==========")
print(mc_summary)

# Interpretation
cat("\n========== INTERPRETATION ==========\n")
if (p_value_before < 0.05) {
  cat("BEFORE: Reject null hypothesis - crime is MORE clustered than expected under population-proportional distribution (p =", round(p_value_before, 4), ")\n")
} else {
  cat("BEFORE: Fail to reject null - crime clustering is consistent with population-proportional distribution (p =", round(p_value_before, 4), ")\n")
}

if (p_value_after < 0.05) {
  cat("AFTER: Reject null hypothesis - crime is MORE clustered than expected under population-proportional distribution (p =", round(p_value_after, 4), ")\n")
} else {
  cat("AFTER: Fail to reject null - crime clustering is consistent with population-proportional distribution (p =", round(p_value_after, 4), ")\n")
}
```

The blue histograms show what Moran's I values look like under the null hypothesis (crime distributed proportionally to population). They're centered around 0 (no spatial autocorrelation).The red dashed line is observed Moran's I - way out in the right tail for both periods.

In both periods, crime is significantly MORE clustered than we would expect if it were simply distributed proportionally to population.
- If crime happened randomly based on where people live, we'd expect Moran's I ‚âà 0
- But we observe Moran's I of 0.27-0.33, which is far outside what we'd expect by chance
- This means there's "excess" spatial clustering of crime beyond what population explains 

## Geographically Weighted Regression

Finally, we fit geographically weighted regression (GWR) models in each period to assess spatial non-stationarity in the association between racial composition and crime rates. For precinct \(p\) with coordinates \((u_p, v_p)\), GWR estimates location-specific coefficients:

$$
CrimeRate_p = \beta_0(u_p,v_p) + \beta_1(u_p,v_p)\%Black_p + \beta_2(u_p,v_p)\%Hispanic_p + \beta_3(u_p,v_p)\%White_p + \varepsilon_p.
$$

An adaptive bandwidth is selected via the standard GWR bandwidth selection routine, and local coefficients (particularly \(\beta_1(u_p,v_p)\)) are mapped for visual comparison across periods. This component is explicitly diagnostic: changes in coefficient heterogeneity can reflect shifts in policing geography, demographic change, or other local dynamics; thus, results are interpreted as evidence of spatial variation rather than causal impact.

GEOGRAPHICALLY WEIGHT REGRESSION
```{r}
# ============================================
# SECTION 12: GEOGRAPHICALLY WEIGHTED REGRESSION
# ============================================

library(spgwr)

# --------------------------------------------
# 12A: Prepare data for GWR - BEFORE period
# --------------------------------------------

# Remove any NAs and prepare sf object
precincts_gwr_before <- precincts_before %>%
  filter(!is.na(crime_rate), !is.na(pct_black), !is.na(pct_hispanic), !is.na(pct_white))

# Get centroids for GWR
coords_before <- st_coordinates(st_centroid(precincts_gwr_before))

# Create sp object
precincts_sp_before <- as(precincts_gwr_before, "Spatial")

# --------------------------------------------
# 12B: Fit GWR - BEFORE period
# --------------------------------------------

cat("=== Fitting GWR for BEFORE period ===\n")

# Bandwidth selection (this may take a moment)
bw_before <- gwr.sel(
  crime_rate ~ pct_black + pct_hispanic + pct_white,
  data = precincts_sp_before,
  coords = coords_before,
  adapt = TRUE
)

cat("Optimal adaptive bandwidth (Before):", round(bw_before, 3), "\n")

# Fit GWR model
gwr_before <- gwr(
  crime_rate ~ pct_black + pct_hispanic + pct_white,
  data = precincts_sp_before,
  coords = coords_before,
  adapt = bw_before,
  hatmatrix = TRUE
)

print(gwr_before)

# --------------------------------------------
# 12C: Prepare data for GWR - AFTER period
# --------------------------------------------

precincts_gwr_after <- precincts_after %>%
  filter(!is.na(crime_rate), !is.na(pct_black), !is.na(pct_hispanic), !is.na(pct_white))

coords_after <- st_coordinates(st_centroid(precincts_gwr_after))

precincts_sp_after <- as(precincts_gwr_after, "Spatial")

# --------------------------------------------
# 12D: Fit GWR - AFTER period
# --------------------------------------------

cat("\n=== Fitting GWR for AFTER period ===\n")

bw_after <- gwr.sel(
  crime_rate ~ pct_black + pct_hispanic + pct_white,
  data = precincts_sp_after,
  coords = coords_after,
  adapt = TRUE
)

cat("Optimal adaptive bandwidth (After):", round(bw_after, 3), "\n")

gwr_after <- gwr(
  crime_rate ~ pct_black + pct_hispanic + pct_white,
  data = precincts_sp_after,
  coords = coords_after,
  adapt = bw_after,
  hatmatrix = TRUE
)

print(gwr_after)

# --------------------------------------------
# 12E: Extract and map local coefficients
# --------------------------------------------

# Extract coefficients from GWR results
gwr_coefs_before <- as.data.frame(gwr_before$SDF)
gwr_coefs_after <- as.data.frame(gwr_after$SDF)

# Add to sf objects
precincts_gwr_before$gwr_pct_black <- gwr_coefs_before$pct_black
precincts_gwr_before$gwr_intercept <- gwr_coefs_before$`(Intercept)`
precincts_gwr_before$gwr_localR2 <- gwr_coefs_before$localR2

precincts_gwr_after$gwr_pct_black <- gwr_coefs_after$pct_black
precincts_gwr_after$gwr_intercept <- gwr_coefs_after$`(Intercept)`
precincts_gwr_after$gwr_localR2 <- gwr_coefs_after$localR2

# --------------------------------------------
# 12F: Map local pct_black coefficients
# --------------------------------------------

# Get consistent color scale
coef_range <- range(c(precincts_gwr_before$gwr_pct_black, precincts_gwr_after$gwr_pct_black))

gwr_map_before <- ggplot(precincts_gwr_before) +
  geom_sf(aes(fill = gwr_pct_black), color = "white", size = 0.2) +
  scale_fill_gradient2(
    low = "#377EB8",      # Blue = negative/weak effect
    mid = "white",
    high = "#E41A1C",     # Red = strong positive effect
    midpoint = 0,
    name = "Local\nCoefficient",
    limits = coef_range
  ) +
  theme_minimal() +
  labs(title = "BEFORE (2010-2012)") +
  theme(
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.grid = element_blank()
  )

gwr_map_after <- ggplot(precincts_gwr_after) +
  geom_sf(aes(fill = gwr_pct_black), color = "white", size = 0.2) +
  scale_fill_gradient2(
    low = "#377EB8",
    mid = "white",
    high = "#E41A1C",
    midpoint = 0,
    name = "Local\nCoefficient",
    limits = coef_range
  ) +
  theme_minimal() +
  labs(title = "AFTER (2013-2019)") +
  theme(
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.grid = element_blank()
  )

gwr_comparison <- gwr_map_before + gwr_map_after +
  plot_annotation(
    title = "GWR: Local Effect of % Black on Crime Rate",
    subtitle = "Red = stronger positive relationship; Blue = weaker/negative relationship"
  )

print(gwr_comparison)
ggsave("gwr_pct_black_comparison.png", gwr_comparison, width = 14, height = 7)

# --------------------------------------------
# 12G: Summary statistics of local coefficients
# --------------------------------------------

cat("\n=== GWR Local Coefficient Summary: pct_black ===\n")

cat("\nBEFORE period:\n")
print(summary(precincts_gwr_before$gwr_pct_black))

cat("\nAFTER period:\n")
print(summary(precincts_gwr_after$gwr_pct_black))

# --------------------------------------------
# 12H: Map local R-squared (model fit)
# --------------------------------------------

r2_range <- range(c(precincts_gwr_before$gwr_localR2, precincts_gwr_after$gwr_localR2))

r2_map_before <- ggplot(precincts_gwr_before) +
  geom_sf(aes(fill = gwr_localR2), color = "white", size = 0.2) +
  scale_fill_viridis_c(
    name = "Local R¬≤",
    limits = r2_range
  ) +
  theme_minimal() +
  labs(title = "BEFORE (2010-2012)") +
  theme(
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.grid = element_blank()
  )

r2_map_after <- ggplot(precincts_gwr_after) +
  geom_sf(aes(fill = gwr_localR2), color = "white", size = 0.2) +
  scale_fill_viridis_c(
    name = "Local R¬≤",
    limits = r2_range
  ) +
  theme_minimal() +
  labs(title = "AFTER (2013-2019)") +
  theme(
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    panel.grid = element_blank()
  )

r2_comparison <- r2_map_before + r2_map_after +
  plot_annotation(
    title = "GWR: Local Model Fit (R¬≤)",
    subtitle = "Higher = demographics explain more crime variation in that area"
  )

print(r2_comparison)
ggsave("gwr_localR2_comparison.png", r2_comparison, width = 14, height = 7)

cat("\n=== GWR ANALYSIS COMPLETE ===\n")
```

# Results


## Global spatial autocorrelation

Violent felony crime rates exhibit statistically meaningful positive spatial autocorrelation in both periods. Before Patternizr, the Global Moran‚Äôs I for precinct crime rate was ùêº = 0.269, indicating moderate spatial clustering. In the post-Patternizr period (2013‚Äì2019), this clustering strengthened to ùêº = 0.341, suggesting that high- and low-crime precincts became more geographically concentrated over time.

Racial composition is substantially more spatially clustered than crime in both periods. The Global Moran‚Äôs I for percent Black population was $ùêº = 0.570$ in 2010‚Äì2012 and remained comparably high in 2013‚Äì2019 ($ùêº = 0.558$). This persistence is consistent with stable patterns of residential segregation at the precinct scale. Notably, while crime clustering increased across periods, the degree of racial clustering changed only marginally.

## Local clustering and overlap of crime and race ‚Äúhot spots‚Äù

Local Indicators of Spatial Association (LISA) provide a complementary view of these patterns. The number of High‚ÄìHigh crime clusters decreased from 6 precincts in 2010‚Äì2012 to 4 precincts in 2013‚Äì2019, indicating fewer statistically significant violent-crime hot spots in the later period. The number of High‚ÄìHigh Black population clusters also declined slightly (from 7 to 6 precincts), again suggesting that the spatial concentration of Black population remained largely stable.

The most consequential local result concerns the intersection of these cluster types. In the pre-Patternizr period, 3 precincts were simultaneously classified as High‚ÄìHigh for crime rates and High‚ÄìHigh for Black population share. 

![](lisa_crime_comparison.png){
  fig-cap="LISA cluster classifications for violent felony crime rates by precinct before (2010‚Äì2012) vs after (2013‚Äì2019) Patternizr. High‚ÄìHigh clusters indicate local crime hot spots."
  fig-alt="Side-by-side LISA cluster maps for crime rates, before vs after."
  fig-align="center"
}

![](lisa_black_comparison.png){
  fig-cap="LISA cluster classifications for percent Black population by precinct (2010 Census vs 2020 Census). High‚ÄìHigh clusters indicate areas of concentrated Black residential presence."
  fig-alt="Side-by-side LISA cluster maps for percent Black population, 2010 vs 2020."
  fig-align="center"
}


In the post-Patternizr period, this overlap fell to 0 precincts. Thus, while both crime and race remained spatially clustered in their own right, the geographic coincidence of Black-population hot spots with violent-crime hot spots disappeared in the post-implementation period.

## Monte Carlo evidence of ‚Äúexcess‚Äù clustering beyond population distribution

Monte Carlo simulations further indicate that the observed crime clustering is unlikely to be attributable to population distribution alone. Under a null model in which crimes are allocated proportionally to precinct population, the probability of observing crime-rate Moran‚Äôs I values as large as those measured is small in both periods (pre: $ùëù = 0.003$; post: $ùëù =0.001$). These results imply that violent crime is significantly more spatially clustered than expected under population-proportional allocation, and that this ‚Äúexcess‚Äù clustering is at least as pronounced‚Äîif not more pronounced‚Äîin the post-Patternizr period.

![](monte_carlo_simulation.png){
  fig-cap="Monte Carlo null distributions of Moran‚Äôs I for crime rates under a population-proportional allocation model. The red dashed line marks the observed Moran‚Äôs I for each period."
  fig-alt="Faceted histograms of simulated Moran‚Äôs I values for before vs after, with observed marked."
  fig-align="center"
}



## Geographically Weighted Regression

To assess spatial non-stationarity in the race‚Äìcrime relationship, we fit geographically weighted regression (GWR) models in each period with precinct violent felony rate as the dependent variable and percent Black, percent Hispanic, and percent White as predictors. Across both periods, the GWR results indicate that the form of the demographic‚Äìcrime relationship changes substantially after Patternizr, shifting from relatively smooth spatial variation to extreme localization and heterogeneity.

In the pre-Patternizr period (2010‚Äì2012), the optimal adaptive bandwidth selected by cross-validation was $q‚âà0.382$, corresponding to approximately 29 of 76 precincts contributing to each local estimate. This relatively large bandwidth implies that local coefficients are estimated using broad neighborhood information, producing a comparatively smooth spatial surface.

![](gwr_pct_black_comparison.png){
  fig-cap="Geographically weighted regression (GWR) local coefficients for percent Black predicting violent felony crime rate. Red indicates stronger positive local association; blue indicates weaker or negative association. Shown for 2010‚Äì2012 vs 2013‚Äì2019."
  fig-alt="Side-by-side maps of GWR local percent Black coefficients, before vs after."
  fig-align="center"
}

Consistent with this, the local %Black coefficient is uniformly positive and tightly distributed across precincts (min = 0.2328, median = 0.3176, max = 0.4034; mean = 0.3183). The quasi-global $ùëÖ^2$ is 0.3585, indicating that allowing coefficients to vary spatially yields a moderate improvement in explanatory power relative to a purely global specification.

![](gwr_localR2_comparison.png){
  fig-cap="GWR local R¬≤ surfaces for 2010‚Äì2012 vs 2013‚Äì2019. Higher values indicate that the local demographic model explains more variance in precinct crime rates in that area."
  fig-alt="Side-by-side maps of GWR local R-squared, before vs after."
  fig-align="center"
}


In the post-Patternizr period (2013‚Äì2019), the optimal bandwidth shrinks dramatically to 
$q‚âà0.022$, corresponding to approximately 1 of 76 precincts contributing to each local estimate. This indicates an extremely localized specification and a strong departure from spatial stationarity. The distribution of local 
%Black coefficients expands sharply and changes qualitatively: coefficients range from negative to extremely large positive values (min = ‚àí3.7466, median = 1.2650, max = 18.1796; mean = 2.4041). The quasi-global $ùëÖ^2$ rises to 0.9391, suggesting that the model‚Äîwhen permitted to vary at highly local scales‚Äîcaptures a very large share of precinct-level variation in crime rates.

However, the post-period GWR fit must be interpreted cautiously. The effective number of parameters increases markedly (approximately 39.2 in the post-period versus 6.7 in the pre-period), reflecting substantially greater model flexibility. As a result, the dramatic increase in quasi-global $ùëÖ^2$ is consistent with heightened spatial heterogeneity but may also reflect overfitting induced by the extremely small adaptive bandwidth.

## Interpretation

Synthesizing the global, local, and GWR results yields a coherent descriptive pattern. First, violent crime becomes more spatially clustered after Patternizr (Moran‚Äôs I: 0.269 ‚Üí 0.341), and this clustering is stronger than would be expected under a population-proportional null model in both periods (Monte Carlo $p=0.003$ pre; $p=0.001$ post). Second, racial composition remains highly clustered and changes little between periods ($I=0.570$ pre; $ùêº=0.558 post$), indicating that segregation-like spatial structure persists regardless of policing regime. Third, despite these persistent forms of clustering, the spatial coincidence of Black-population hot spots and violent-crime hot spots disappears (overlap: 3 ‚Üí 0 precincts).

The GWR results provide a plausible statistical complement to this spatial decoupling: before Patternizr, the association between %Black and crime rate is consistently positive and spatially smooth, whereas after Patternizr the relationship becomes sharply non-stationary, varying widely in magnitude and even sign across precincts. In practical terms, this implies that the post-Patternizr period is less well described by a single citywide race‚Äìcrime gradient and more consistent with localized, place-specific dynamics. Importantly, this change is observational and does not, by itself, identify a causal effect of Patternizr. The post-period encompasses substantial social and demographic change, and the extreme localization implied by the selected bandwidth suggests that any causal interpretation would require additional identification strategies and sensitivity analyses.